<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Practice Cards Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a2e;
            color: white;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #58cc02;
            border-radius: 10px;
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            background: #58cc02;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #4ba002;
        }
        .response {
            margin-top: 10px;
            padding: 10px;
            background: #0f0f23;
            border-radius: 5px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .error {
            color: #ff6b6b;
        }
        .success {
            color: #58cc02;
        }
    </style>
</head>
<body>
    <h1>Practice Cards API Test</h1>
    
    <div class="test-section">
        <h2>Test Each Practice Type</h2>
        <button onclick="testCategory('trivia_mix')">Test Trivia/Factoids</button>
        <button onclick="testCategory('famous_quotes')">Test Famous Quotes</button>
        <button onclick="testCategory('bad_puns')">Test Bad Puns</button>
        <button onclick="testCategory('knock_knock')">Test Knock Knock</button>
        <div id="apiResponse" class="response"></div>
    </div>

    <div class="test-section">
        <h2>Test FlashcardModal</h2>
        <button onclick="openFlashcardModal('trivia_mix')">Open Trivia Modal</button>
        <button onclick="openFlashcardModal('famous_quotes')">Open Quotes Modal</button>
        <button onclick="openFlashcardModal('bad_puns')">Open Puns Modal</button>
        <button onclick="openFlashcardModal('knock_knock')">Open Knock Knock Modal</button>
        <div id="modalStatus" class="response"></div>
    </div>

    <script>
        const API_URL = 'https://p0qp0q.com';
        
        async function testCategory(category) {
            const responseDiv = document.getElementById('apiResponse');
            responseDiv.innerHTML = `Testing ${category}...`;
            
            try {
                const response = await fetch(`${API_URL}/api/flashcards`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ category, count: 3 })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    responseDiv.innerHTML = `<span class="success">✓ ${category} returned ${data.cards.length} cards</span>\n`;
                    responseDiv.innerHTML += `Sample card:\n${JSON.stringify(data.cards[0], null, 2)}`;
                    
                    // Check for common issues
                    const card = data.cards[0];
                    const issues = [];
                    
                    if (category === 'trivia_mix' && !card.fact) {
                        issues.push('Missing "fact" property for trivia card');
                    }
                    if (category === 'knock_knock' && (!card.whosThere || !card.punchline)) {
                        issues.push('Missing knock-knock properties');
                    }
                    if (category === 'bad_puns' && !card.punchline) {
                        issues.push('Missing punchline for pun');
                    }
                    if (category === 'famous_quotes' && (!card.content || !card.author)) {
                        issues.push('Missing quote content or author');
                    }
                    
                    if (issues.length > 0) {
                        responseDiv.innerHTML += `\n\n<span class="error">Issues found:</span>\n${issues.join('\n')}`;
                    }
                } else {
                    responseDiv.innerHTML = `<span class="error">✗ Error: ${response.status}</span>\n${JSON.stringify(data, null, 2)}`;
                }
            } catch (error) {
                responseDiv.innerHTML = `<span class="error">✗ Network error: ${error.message}</span>`;
            }
        }
        
        function openFlashcardModal(category) {
            const statusDiv = document.getElementById('modalStatus');
            statusDiv.innerHTML = `To test the modal, open the main app and click on a ${category} practice card.\n`;
            statusDiv.innerHTML += `Check for:\n`;
            statusDiv.innerHTML += `- Card flip animation\n`;
            statusDiv.innerHTML += `- Proper content display\n`;
            statusDiv.innerHTML += `- Button functionality\n`;
            statusDiv.innerHTML += `- Mobile responsiveness\n`;
            statusDiv.innerHTML += `- Wonder meter (for factoids)\n`;
            statusDiv.innerHTML += `- Giggle meter (for puns/jokes)\n`;
        }
    </script>
</body>
</html>